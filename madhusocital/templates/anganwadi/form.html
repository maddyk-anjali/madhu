<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mother Card Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .section-border {
            border: 1px solid #374151;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            background-color: #1f2937;
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #6ee7b7; /* Teal-400 */
            margin-bottom: 1rem;
            border-bottom: 2px solid #374151;
            padding-bottom: 0.5rem;
        }
        .form-label {
            font-weight: 600;
            color: #9ca3af; /* Gray-400 */
        }
        .form-input {
            border: 1px solid #374151;
            border-radius: 0.375rem;
            padding: 0.5rem 0.75rem;
            width: 100%;
            background-color: #374151;
            color: #f3f4f6; /* Gray-100 */
        }
        .form-input:focus {
            outline: none;
            border-color: #6ee7b7; /* Teal-400 */
            box-shadow: 0 0 0 3px rgba(110, 231, 183, 0.5); /* Teal-400 with opacity */
        }
        .submit-btn {
            background-color: #6ee7b7; /* Teal-400 */
            color: #1f2937; /* Gray-900 */
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }
        .submit-btn:hover {
            background-color: #34d399; /* Teal-500 */
        }
    </style>
</head>
<body class="bg-[#121212] text-white">
    <!-- ðŸŒŸ Navbar -->
    {% include "anganwadi/nav.html" %}

    <div class="max-w-5xl mx-auto bg-gray-900 shadow-md rounded-lg p-6 mt-10">
        <h2 class="text-3xl font-bold text-teal-400 mb-4 text-center">Mother Card Registration</h2>

        <!-- Form -->
        <form id="registrationForm" method="POST" class="bg-gray-800 shadow-lg rounded-lg px-8 pt-6 pb-8 mb-4">
            <!-- Personal Information Section -->
            <div class="section-border">
                <h2 class="section-title">Personal Information</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label" for="mother_name">Mother's Name</label>
                        <input class="form-input" id="mother_name" name="mother_name" type="text" required>
                    </div>
                    <div>
                        <label class="form-label" for="husband_name">Husband's Name</label>
                        <input class="form-input" id="husband_name" name="husband_name" type="text" required>
                    </div>
                    <div>
                        <label class="form-label" for="last_name">Last Name</label>
                        <input class="form-input" id="last_name" name="last_name" type="text">
                    </div>
                    <div>
                        <label class="form-label" for="date_of_birth">Date of Birth</label>
                        <input class="form-input" id="date_of_birth" name="date_of_birth" type="date" required>
                    </div>
                    <div>
                        <label class="form-label" for="aadhar_number">Aadhar Number</label>
                        <input class="form-input" id="aadhar_number" name="aadhar_number" type="text" pattern="^[0-9]{12}$" required>
                    </div>
                    <div>
                        <label class="form-label" for="phone_number">Phone Number</label>
                        <input class="form-input" id="phone_number" name="phone_number" type="text" pattern="^[0-9]{10,15}$" required>
                    </div>
                    <div>
                        <label class="form-label" for="email">Email</label>
                        <input class="form-input" id="email" name="email" type="email" required>
                    </div>
                    <div>
                        <label class="form-label" for="address">Address</label>
                        <input class="form-input" id="address" name="address" type="text" required>
                    </div>
                </div>
            </div>

            <!-- Anganwadi & Staff Details Section -->
            <div class="section-border">
                <h2 class="section-title">Anganwadi & Staff Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label" for="anganwadi_name">Anganwadi Name</label>
                        <input class="form-input" id="anganwadi_name" name="anganwadi_name" type="text" required>
                    </div>
                    <div>
                        <label class="form-label" for="anganwadi_staff_name">Anganwadi Staff Name</label>
                        <input class="form-input" id="anganwadi_staff_name" name="anganwadi_staff_name" type="text" required>
                    </div>
                    <div>
                        <label class="form-label" for="asha_staff_name">ASHA Staff Name</label>
                        <input class="form-input" id="asha_staff_name" name="asha_staff_name" type="text">
                    </div>
                    <div>
                        <label class="form-label" for="district">District</label>
                        <input class="form-input" id="district" name="district" type="text" required>
                    </div>
                    <div>
                        <label class="form-label" for="taluk">Taluk</label>
                        <input class="form-input" id="taluk" name="taluk" type="text" required>
                    </div>
                    <div>
                        <label class="form-label" for="anganwadi_address">Anganwadi Address</label>
                        <input class="form-input" id="anganwadi_address" name="anganwadi_address" type="text" required>
                    </div>
                </div>
            </div>

            <!-- Health Information Section -->
            <div class="section-border">
                <h2 class="section-title">Health Information</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label" for="blood_group">Blood Group</label>
                        <select class="form-input" id="blood_group" name="blood_group">
                            <option value="">Select</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label" for="height_cm">Height (cm)</label>
                        <input class="form-input" id="height_cm" name="height_cm" type="number" min="50" max="250">
                    </div>
                    <div>
                        <label class="form-label" for="weight_kg">Weight (kg)</label>
                        <input class="form-input" id="weight_kg" name="weight_kg" type="number" min="30" max="150" step="0.1">
                    </div>
                    <div>
                        <label class="form-label" for="number_of_pregnancies">Number of Pregnancies</label>
                        <input class="form-input" id="number_of_pregnancies" name="number_of_pregnancies" type="number" min="0" value="0">
                    </div>
                    <div>
                        <label class="form-label" for="expected_delivery_date">Expected Delivery Date</label>
                        <input class="form-input" id="expected_delivery_date" name="expected_delivery_date" type="date">
                    </div>
                    <div>
                        <label class="form-label" for="last_menstrual_period">Last Menstrual Period</label>
                        <input class="form-input" id="last_menstrual_period" name="last_menstrual_period" type="date">
                    </div>
                </div>
            </div>
            <div>
                <label class="form-label" for="userid">User</label>
                <select class="form-input" id="userid" name="userid" required>
                    <option value="">Select User</option>
                </select>
            </div>
          <!-- Agreement Section -->
            <div class="mb-6">
                <label class="form-label" for="terms_agreed">
                    <input class="mr-2 leading-tight" id="terms_agreed" name="terms_agreed" type="checkbox" required>
                    I agree to the terms and conditions
                </label>
            </div>

            <!-- Submit Button -->
            <div class="flex items-center justify-center">
                <button class="submit-btn" type="submit">
                    Register
                </button>
            </div>
        </form>
    </div>

    <!-- ðŸŒŸ Footer -->
    <footer class="bg-[#121212] text-white text-center py-4 mt-10">
        <p>&copy; 2025 Anganwadi Portal. All Rights Reserved.</p>
    </footer>

    <script>
        document.getElementById('registrationForm').addEventListener('submit', async (event) => {
            event.preventDefault();

            const formData = new FormData(event.target);
            const data = {};

            // Convert FormData to an object, skipping empty fields
            for (const [key, value] of formData.entries()) {
                if (value !== "") {
                    data[key] = value;
                }
            }

            // Convert checkbox values to boolean
            data.terms_agreed = data.terms_agreed === 'on';

            console.log("Submitting data:", data); // Log the data being sent

            try {
                const response = await fetch('/register_mother', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });

                if (response.ok) {
                    alert('Mother registered successfully!');
                    event.target.reset();
                } else {
                    const errorData = await response.json();
                    alert(`Error: ${errorData.detail}`);
                }
            } catch (error) {
                alert('An error occurred while submitting the form.');
                console.error(error);
            }
        });

        document.addEventListener("DOMContentLoaded", async () => {
    const userDropdown = document.getElementById("userid");

    try {
        const response = await fetch("/user_ids");
        const data = await response.json();

        data.users.forEach(user => {
            const option = document.createElement("option");
            option.value = user.id;
            option.textContent = `${user.id} - ${user.username}`;  // Show both ID and Username
            userDropdown.appendChild(option);
        });
    } catch (error) {
        console.error("Error fetching user IDs:", error);
    }
});



    </script>
</body>
</html>